import { Note, Tip } from "@/components/Advice";

# TypeScript Versions

TSTyche makes it a breeze to be sure your types are compatible with specific versions of TypeScript.

## Support Policy

Most of the projects choose to support a single TypeScript version or declare the lowest supported version.

Testing against a single version is simple. If the `typescript` package is installed, TSTyche will load it. Otherwise, the latest version of TypeScript will be used.

<Tip>

To specify another version, pass it with the [`--target`](../reference/command-line.mdx#target) command line option or use the [`target`](../reference/config-file.mdx#target) configuration option.

</Tip>

## Range of Versions

Keep in mind that TypeScript follows the Semantic Versioning specification only [partly](https://github.com/microsoft/TypeScript/wiki/TypeScript's-Release-Process/e669ab1ad96edc1a7bcef5f6d9e35e24397891e5). A patch release is still strictly only a bug fix, but a major release may introduce breaking changes. This means upgrading from `5.6` to `5.7` can break your types.

For instance, if your project declares that the lowest supported TypeScript version is `5.6`, it is recommended to test against all major versions starting with that one:

```shell
tstyche --target '>=5.6'
```

This command will test using TypeScript `5.6`, `5.7`, `5.8` and so on. The newly released versions will be added as soon as they are available.

To learn more about the version ranges, see the [Ranges](../reference/command-line.mdx#ranges) chapter in the documentation of the `--target` command line option.

<Tip>

Running tests against many versions of TypeScript is slow. Use ranges only in continuous integration workflows. If something fails, run TSTyche locally targeting that single version.

</Tip>

## Handling Changes

Changes between TypeScript versions can be handled using the `// @tstyche if` comment directive:

```ts
import { expect, test } from "tstyche";

function isUint8Array(input: unknown): input is Uint8Array {
  return input instanceof Uint8Array;
}

test("isUint8Array", () => {
  const unknowns: Array<unknown> = [];

  // @tstyche if { target: [">=5.7"] }
  expect(unknowns.filter(isUint8Array)).type.toBe<Array<Uint8Array<ArrayBufferLike>>>();

  // @tstyche if { target: ["<5.7"] } -- Before TypeScript 5.7, 'Uint8Array' was not generic
  expect(unknowns.filter(isUint8Array)).type.toBe<Array<Uint8Array>>();
});
```

The directive can conditionally skip an `expect()`, `test()`, `describe()` or entire test file (when specified at the top of a file).

## Early Warnings

TSTyche supports `beta`, `latest`, `next` or `rc` as the target tags. Use them as one-off commands or in continuous integration workflows.

To catch the breaking changes early, consider setting up a workflow that runs tests once a day against `typescript@next`. A GitHub Actions example can be found in [`tstyche/ts-nightly-example`](https://github.com/tstyche/ts-nightly-example) repository.

<Note>

[`typescript-go`](https://github.com/microsoft/typescript-go) is not yet supported, but is definitely worth a go! For updates, please follow [tstyche/tstyche#443](https://github.com/tstyche/tstyche/issues/443).

</Note>
