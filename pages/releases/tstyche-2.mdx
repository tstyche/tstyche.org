import { FileTree, Tabs } from "nextra/components";
import { Note, Tip } from "@/components/Advice";

# Release Notes

This page lists breaking changes and notable new features. Please be sure to read the release notes before upgrading from previous version.

<Note>

The detailed changelog can be found in [TSTyche repository on GitHub](https://github.com/tstyche/tstyche/blob/main/RELEASES.md).

</Note>

## TSTyche 2.0  [#tstyche-2-0]

TSTyche 2.0 ships with more matchers, performance refinements and the watch mode.

### Requirements

The minimum required Node.js version is `16.14`. It is recommended to use the latest Long Term Support (LTS) release.

Testing on specific version of TypeScript requires Node.js 18 or later. The global [`fetch()`](https://developer.mozilla.org/en-US/docs/Web/API/fetch) method is now used to fetch the `typescript` package metadata from the registry.

### Configuration

#### `testFileMatch` [#test-file-match]

The logic of glob pattern matching is reworked. Current implementation allows selecting all matching paths including `.json` or `.mdx` files.

For instance, to avoid selecting the `__tests__/tsconfig.json` as a test file:

<FileTree>
  <FileTree.Folder name="__tests__" defaultOpen>
    <FileTree.File name="Emitter.ts" />
    <FileTree.File name="Semaphore.ts" />
    <FileTree.File name="tsconfig.json" />
  </FileTree.Folder>
  <FileTree.File name="package.json" />
  <FileTree.File name="tstyche.config.json" />
</FileTree>

A `*.ts` must be added to the pattern:

```diff filename="./tstyche.config.json"
{
- "testFileMatch": ["__tests__"]
+ "testFileMatch": ["__tests__/*.ts"]
}
```

### Test Runner

#### `--watch` [#watch]

The watch mode is added. Current implementation is watching the TSTyche configuration file and the test files for changes.

```shell
tstyche --watch
```

Files are watched recursively using the [`fs.watch()`](https://nodejs.org/docs/latest/api/fs.html#fswatchfilename-options-listener) method that relies on file system events.

<Note>

In some cases this feature is [not available](https://nodejs.org/docs/latest/api/fs.html#availability). For example, it does not work on network file systems. Also note that recursive watch support was added for the Linux systems only since Node.js 20.

</Note>

### Matchers

#### `.toBe()` [#to-be]

`.toBe()` is the new name of `.toEqual()`.

```diff
import { expect } from "tstyche";

- expect<{ a: string }>().type.toEqual<{ a: string }>();
+ expect<{ a: string }>().type.toBe<{ a: string }>();

- expect<{ a: string }>().type.not.toEqual<{ b: number }>();
+ expect<{ a: string }>().type.not.toBe<{ b: number }>();
```

The new name simplifies swapping between the [primitive type matchers](../reference/expect-api.mdx#primitive-type-matchers) and `.toBe()`. For example, replacing `.toBeString()` with `.toBe<string | undefined>()` looks more clear than before.

#### `.toBeAssignableTo()` [#to-be-assignable-to]

`.toBeAssignableTo()` is a new matcher, it checks if the source type is assignable to the target type. The opposite of [`.toBeAssignableWith()`](#to-be-assignable-with).

```ts
import { expect } from "tstyche";

expect<{ a: string; b: number }>().type.toBeAssignableTo<{ a: string }>();
expect<{ a: string }>().type.not.toBeAssignableTo<{ a: string; b: number }>();
```

#### `.toBeAssignableWith()` [#to-be-assignable-with]

`.toBeAssignableWith()` is the new name of `.toBeAssignable()`, it checks if the source type is assignable with the target type. The opposite of [`.toBeAssignableTo()`](#to-be-assignable-to).

```diff
import { expect } from "tstyche";

- expect<{ a: string }>().type.toBeAssignable<{ a: string; b: number }>();
+ expect<{ a: string }>().type.toBeAssignableWith<{ a: string; b: number }>();

- expect<{ a: string; b: number }>().type.not.toBeAssignable<{ a: string }>();
+ expect<{ a: string; b: number }>().type.not.toBeAssignableWith<{ a: string }>();
```

The `.toBeAssignableTo()` and `.toBeAssignableWith()` matchers allow checking assignability both ways and make it easier to understand what is being tested.

<Tip>

Which one to use? It depends on what you are testing. A good rule of thumb is to keep the type under test on the left hand side of the assertion.

</Tip>
